name: Notify Discord on Commit

on:
  push:

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send commit info to Discord
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          AUTHOR="${{ github.event.head_commit.author.name }}"
          MESSAGE="${{ github.event.head_commit.message }}"
          TIME="${{ github.event.head_commit.timestamp }}"
          REPO="${{ github.repository }}"
          URL="${{ github.event.head_commit.url }}"

          curl -H "Content-Type: application/json" \
          -X POST \
          -d "{
            \"username\": \"GitHub\",
            \"embeds\": [{
              \"title\": \"ğŸ“¦ New Commit\",
              \"color\": 5814783,
              \"fields\": [
                {\"name\": \"ğŸ‘¤ à¸œà¸¹à¹‰ commit\", \"value\": \"${AUTHOR}\", \"inline\": true},
                {\"name\": \"ğŸ•’ à¹€à¸§à¸¥à¸²\", \"value\": \"${TIME}\", \"inline\": true},
                {\"name\": \"ğŸ“ à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡\", \"value\": \"${MESSAGE}\"},
                {\"name\": \"ğŸ“ Repository\", \"value\": \"${REPO}\"},
                {\"name\": \"ğŸ”— à¸”à¸¹ commit\", \"value\": \"[Click here](${URL})\"}
              ]
            }]
          }" \
          $DISCORD_WEBHOOK
